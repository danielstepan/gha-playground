name: List Changed Files

on:
  issue_comment:
    types: [created]

jobs:
  list_changed_files:
    if: startsWith(github.event.comment.body, '/list') && github.event.issue.pull_request
    runs-on: ubuntu-latest
    env:
      GH_TOKEN: ${{ secrets.GITHUB_TOKEN }} 

    steps:
    - name: Check out the code
      uses: actions/checkout@v3

    - name: Say hello world
      run: |
        echo "Hello world from Pull Request!"
     
    - name: Get pull request number
      id: pr
      run: |
        echo "PR_NUMBER=$(echo "${{ github.event.issue.number }}")" >> $GITHUB_ENV
  
    - name: Get list of changed files
      run: |
        CHANGED_FILES=$(gh pr diff $PR_NUMBER --name-only)
        echo "CHANGED_FILES=$CHANGED_FILES" >> $GITHUB_ENV
  